define(["core/ajax","core/notification"],function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=n(t),s=n(e);const{call:c}=o.default,a=t=>{const e=new Map;return{getElement(n){const o=`${n}-${t}`;return e.has(o)||e.set(o,document.getElementById(o)),e.get(o)},setText(t,e){const n=this.getElement(t);n&&(n.textContent=e)},toggleElement(t,e){const n=this.getElement(t);n&&n.classList.toggle("hidden",!e)},setButton(t,e,n){const o=this.getElement(t);o&&(o.disabled=e,o.textContent=n,o.classList.toggle("processing",e))}}};return{authorizeNetPayment:function(t,e){const n=a(t),o=n.getElement("enrolbutton"),r=n.getElement("paymentresponse");r&&r.classList.add("hidden");const i=async()=>{if(o){n.setButton("enrolbutton",!0,"Processing..."),n.toggleElement("paymentresponse",!1);try{const n=await((t,e)=>c([{methodname:"enrol_authorizedotnet_get_hosted_payment_url",args:{instanceid:t,userid:e}}])[0])(t,e);!0===n.status?((t,e)=>{const n=document.createElement("form");n.method="post",n.action=t;const o=document.createElement("input");o.type="hidden",o.name="token",o.value=e,n.appendChild(o),document.body.appendChild(n),n.submit()})(n.formurl,n.token):console.error(n.error)}catch(t){s.default.exception(t),n.setButton("enrolbutton",!1,"Pay Now")}}};o&&o.addEventListener("click",i)}}});
