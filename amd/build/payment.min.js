define(["core/ajax","core/notification"],function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=n(t),s=n(e);const{call:a}=o.default,r=t=>{const e=new Map;return{getElement(n){const o=`${n}-${t}`;return e.has(o)||e.set(o,document.getElementById(o)),e.get(o)},setText(t,e){const n=this.getElement(t);n&&(n.textContent=e)},toggleElement(t,e){const n=this.getElement(t);n&&n.classList.toggle("hidden",!e)},setButton(t,e,n){const o=this.getElement(t);o&&(o.disabled=e,o.textContent=n,o.classList.toggle("processing",e))}}};return{authorizeNetPayment:function(t,e){const n=r(t),o=n.getElement("enrolbutton"),l=n.getElement("paymentresponse");l&&l.classList.add("hidden");const i=async()=>{if(o){n.setButton("enrolbutton",!0,"Processing..."),n.toggleElement("paymentresponse",!1);try{const o=await((t,e)=>a([{methodname:"enrol_authorizedotnet_get_hosted_payment_url",args:{instanceid:t,userid:e}}])[0])(t,e);o?.status&&o.url?window.location.href=o.url:(r=o?.error||"Unable to initiate payment.",l&&(n.setText("paymentresponse",r),n.toggleElement("paymentresponse",!0)),n.setButton("enrolbutton",!1,"Pay Now"))}catch(t){s.default.exception(t),n.setButton("enrolbutton",!1,"Pay Now")}var r}};o&&o.addEventListener("click",i)}}});
