define(["core/ajax","core/notification"],function(e,t){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=a(e),n=a(t);return{init:(e,t,a)=>{const o=document.getElementById(`payment_form-${e}`);if(!o)return void console.error("Payment form not found!");const u=o.querySelector("button[type=submit]");o.addEventListener("submit",async t=>{t.preventDefault(),u&&(u.disabled=!0);const a={cardnumber:o.querySelector("[name=cardnumber]").value,expmonth:o.querySelector("[name=expmonth]").value,expyear:o.querySelector("[name=expyear]").value,cardcode:o.querySelector("[name=cardcode]").value,firstname:o.querySelector("[name=firstname]").value,lastname:o.querySelector("[name=lastname]").value,email:o.querySelector("[name=email]").value,phone:o.querySelector("[name=phone]").value,address:o.querySelector("[name=address]").value,city:o.querySelector("[name=city]").value,state:o.querySelector("[name=state]").value,zip:o.querySelector("[name=zip]").value,country:o.querySelector("[name=country]").value};try{const t=await((e,t)=>r.default.call([{methodname:"enrol_authorizedotnet_process_payment",args:{instanceid:e,paymentdata:t}}])[0])(e,a);t.status?window.location.href=t.redirecturl:(n.default.add(t.message||"Payment failed",{type:"error"}),u&&(u.disabled=!1))}catch(e){n.default.exception(e),u&&(u.disabled=!1)}})}}});
